(()=>{"use strict";var e,n={890:(e,n,t)=>{const a=window.wp.blocks,o=window.wp.i18n,l=window.React,r=window.wp.components,c=window.wp.element,s=window.wp.blockEditor,i=window.wp.primitives,m=(0,l.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(i.Path,{fillRule:"evenodd",d:"M10.289 4.836A1 1 0 0111.275 4h1.306a1 1 0 01.987.836l.244 1.466c.787.26 1.503.679 2.108 1.218l1.393-.522a1 1 0 011.216.437l.653 1.13a1 1 0 01-.23 1.273l-1.148.944a6.025 6.025 0 010 2.435l1.149.946a1 1 0 01.23 1.272l-.653 1.13a1 1 0 01-1.216.437l-1.394-.522c-.605.54-1.32.958-2.108 1.218l-.244 1.466a1 1 0 01-.987.836h-1.306a1 1 0 01-.986-.836l-.244-1.466a5.995 5.995 0 01-2.108-1.218l-1.394.522a1 1 0 01-1.217-.436l-.653-1.131a1 1 0 01.23-1.272l1.149-.946a6.026 6.026 0 010-2.435l-1.148-.944a1 1 0 01-.23-1.272l.653-1.131a1 1 0 011.217-.437l1.393.522a5.994 5.994 0 012.108-1.218l.244-1.466zM14.929 12a3 3 0 11-6 0 3 3 0 016 0z",clipRule:"evenodd"})),p=(0,l.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(i.Path,{d:"M16 10h4c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1h-4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1zm-8 4H4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm10-2.6L14.5 15l1.1 1.1 1.7-1.7c-.1 1.1-.3 2.3-.9 2.9-.3.3-.7.5-1.3.5h-4.5v1.5H15c.9 0 1.7-.3 2.3-.9 1-1 1.3-2.7 1.4-4l1.8 1.8 1.1-1.1-3.6-3.7zM6.8 9.7c.1-1.1.3-2.3.9-2.9.4-.4.8-.6 1.3-.6h4.5V4.8H9c-.9 0-1.7.3-2.3.9-1 1-1.3 2.7-1.4 4L3.5 8l-1 1L6 12.6 9.5 9l-1-1-1.7 1.7z"})),d=window.wp.apiFetch;var v=t.n(d);const u=window.wp.escapeHtml;(0,a.registerBlockType)("openverse-connect/search",{title:(0,o.__)("Openverse Search","openverse-connect"),description:(0,o.__)("Search and insert media from Openverse","openverse-connect"),icon:"search",category:"media",keywords:[(0,o.__)("openverse","openverse-connect"),(0,o.__)("image","openverse-connect"),(0,o.__)("search","openverse-connect")],edit:function({attributes:e,setAttributes:n}){const t=(0,s.useBlockProps)(),{query:a,mediaType:i,license:d,selectedMedia:_,showAttribution:h,imageSize:g,maxWidth:b,altText:E}=e,[C,w]=(0,c.useState)([]),[f,S]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),[N,T]=(0,c.useState)(1),[k,B]=(0,c.useState)(!1),[M,z]=(0,c.useState)(!1),O=(0,c.useRef)(null),A=async(e=!0)=>{if(a.trim()){S(!0),y(null);try{const n=e?1:N,t=await v()({path:`/openverse-connect/v1/search?q=${encodeURIComponent(a)}&page=${n}&media_type=${i}&license=${d}`,method:"GET"});t.results?(e?(w(t.results),T(1)):w([...C,...t.results]),B(t.page_count>n)):(y((0,o.__)("No results found","openverse-connect")),w([]))}catch(e){y((0,o.__)("Error searching Openverse","openverse-connect")),console.error("Openverse search error:",e)}finally{S(!1)}}},P=e=>{const n=e.replace(/<\/?[^>]+(>|$)/g,"");return(0,u.escapeHTML)(n)},Y=[{label:(0,o.__)("All licenses","openverse-connect"),value:"all"},{label:(0,o.__)("CC BY","openverse-connect"),value:"BY"},{label:(0,o.__)("CC BY-SA","openverse-connect"),value:"BY-SA"},{label:(0,o.__)("CC BY-ND","openverse-connect"),value:"BY-ND"},{label:(0,o.__)("CC BY-NC","openverse-connect"),value:"BY-NC"},{label:(0,o.__)("CC BY-NC-SA","openverse-connect"),value:"BY-NC-SA"},{label:(0,o.__)("CC BY-NC-ND","openverse-connect"),value:"BY-NC-ND"},{label:(0,o.__)("CC0","openverse-connect"),value:"CC0"},{label:(0,o.__)("Public Domain Mark","openverse-connect"),value:"PDM"}],W=[{label:(0,o.__)("Images","openverse-connect"),value:"image"},{label:(0,o.__)("Audio","openverse-connect"),value:"audio"}],D=[{label:(0,o.__)("Small","openverse-connect"),value:"small"},{label:(0,o.__)("Medium","openverse-connect"),value:"medium"},{label:(0,o.__)("Large","openverse-connect"),value:"large"}],L=()=>(0,l.createElement)(l.Fragment,null,(0,l.createElement)(r.ToggleControl,{label:(0,o.__)("Show Attribution","openverse-connect"),checked:h,onChange:e=>{n({showAttribution:e})}}),"image"===i&&(0,l.createElement)(r.TextControl,{label:(0,o.__)("Alt Text","openverse-connect"),value:E,onChange:e=>n({altText:P(e)}),help:(0,o.__)("Alternative text describes your image to people who can't see it. Add a short description with its key details.","openverse-connect")}));return(0,l.createElement)(l.Fragment,null,_&&!M&&(0,l.createElement)(s.BlockControls,null,(0,l.createElement)(r.ToolbarGroup,null,(0,l.createElement)(r.ToolbarButton,{icon:p,label:(0,o.__)("Choose Different Media","openverse-connect"),onClick:()=>{n({selectedMedia:null}),O.current=_,z(!0)}}),(0,l.createElement)((()=>(0,l.createElement)(r.Dropdown,{className:"openverse-media-settings-dropdown",contentClassName:"openverse-media-settings-dropdown-content",popoverProps:{placement:"bottom-start",offset:20,shift:!0,flip:!0,resize:!0,headerTitle:(0,o.__)("Media Settings","openverse-connect")},renderToggle:({isOpen:e,onToggle:n})=>(0,l.createElement)(r.ToolbarButton,{icon:m,label:(0,o.__)("Media Settings","openverse-connect"),onClick:n,"aria-expanded":e,isPressed:e}),renderContent:()=>(0,l.createElement)("div",{className:"openverse-media-settings-panel",style:{minWidth:"300px",maxWidth:"500px",height:"auto",padding:"20px",margin:"auto"}},(0,l.createElement)(L,null))})),null),"image"===i&&(0,l.createElement)((()=>(0,l.createElement)(r.Dropdown,{className:"openverse-image-size-dropdown",contentClassName:"openverse-image-size-dropdown-content",popoverProps:{placement:"bottom-start",offset:20,shift:!0,flip:!0,resize:!0,headerTitle:(0,o.__)("Image Size","openverse-connect")},renderToggle:({isOpen:e,onToggle:n})=>(0,l.createElement)(r.ToolbarButton,{icon:"editor-expand",label:(0,o.__)("Image Size","openverse-connect"),onClick:n,"aria-expanded":e,isPressed:e}),renderContent:()=>(0,l.createElement)("div",{className:"openverse-image-size-panel",style:{padding:"12px",minWidth:"200px"}},(0,l.createElement)(r.SelectControl,{label:(0,o.__)("Image Size","openverse-connect"),value:g,options:D,onChange:e=>n({imageSize:e})}),(0,l.createElement)(r.RangeControl,{label:(0,o.__)("Maximum Width (%)","openverse-connect"),value:b,onChange:e=>n({maxWidth:e}),min:10,max:100}))})),null))),(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(r.PanelBody,{title:(0,o.__)("Media Settings","openverse-connect"),initialOpen:!0},(0,l.createElement)(L,null),"image"===i&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(r.SelectControl,{label:(0,o.__)("Image Size","openverse-connect"),value:g,options:D,onChange:e=>n({imageSize:e})}),(0,l.createElement)(r.RangeControl,{label:(0,o.__)("Maximum Width (%)","openverse-connect"),value:b,onChange:e=>n({maxWidth:e}),min:10,max:100})))),(0,l.createElement)("div",{...t},_&&!M?_?(0,l.createElement)("div",{className:"openverse-selected-media"},"image"===i?(0,l.createElement)("img",{src:_.thumbnail||_.url,alt:E||_.title||"",className:`size-${g}`,style:{maxWidth:`${b}%`}}):(0,l.createElement)("audio",{controls:!0},(0,l.createElement)("source",{src:_.url,type:"audio/mpeg"}),(0,o.__)("Your browser does not support the audio element.","openverse-connect")),h&&(($=_)?(0,l.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},(0,o.__)("Creator:","openverse-connect")," ",$.creator||(0,o.__)("Unknown","openverse-connect")," |",(0,o.__)("License:","openverse-connect")," ",$.license):null)):null:(0,l.createElement)("div",{className:"openverse-search-interface"},(0,l.createElement)(r.Placeholder,{icon:"search",label:(0,o.__)("Openverse Media Search","openverse-connect"),instructions:(0,o.__)("Search for free and openly licensed media from Openverse","openverse-connect")},(0,l.createElement)("div",{className:"openverse-search-controls"},(0,l.createElement)(r.SelectControl,{label:(0,o.__)("Media Type","openverse-connect"),value:i,options:W,onChange:e=>n({mediaType:e})}),(0,l.createElement)(r.SelectControl,{label:(0,o.__)("License","openverse-connect"),value:d,options:Y,onChange:e=>n({license:e})}),(0,l.createElement)(r.TextControl,{label:(0,o.__)("Search Query","openverse-connect"),value:a,onChange:e=>n({query:e}),placeholder:(0,o.__)("Enter search terms...","openverse-connect")}),(0,l.createElement)("div",{className:"openverse-search-buttons"},(0,l.createElement)(r.Button,{isPrimary:!0,onClick:()=>A(!0),disabled:!a.trim()||f},f?(0,l.createElement)(r.Spinner,null):(0,o.__)("Search","openverse-connect")),O.current&&(0,l.createElement)(r.Button,{isSecondary:!0,onClick:()=>{n({query:"",mediaType:"image",license:"all"}),w([]),z(!1),O.current&&n({selectedMedia:O.current})},className:"openverse-cancel-search"},(0,o.__)("Cancel","openverse-connect"))))),x&&(0,l.createElement)("div",{className:"openverse-error-message"},x),C.length>0&&(0,l.createElement)("div",{className:"openverse-search-results"},(0,l.createElement)("h3",null,(0,o.__)("Search Results","openverse-connect")),(0,l.createElement)("div",{className:"openverse-results-grid"},C.map((e=>(0,l.createElement)("div",{key:e.id,className:"openverse-result-item",onClick:()=>(e=>{const t=e.title||"";n({selectedMedia:e,altText:E||P(t)})})(e)},"image"===i?(0,l.createElement)("img",{src:e.thumbnail,alt:e.title}):(0,l.createElement)("div",{className:"openverse-audio-item"},(0,l.createElement)("span",{className:"dashicons dashicons-format-audio"}),(0,l.createElement)("span",{className:"openverse-audio-title"},e.title)))))),k&&(0,l.createElement)(r.Button,{onClick:()=>{T(N+1),A(!1)},disabled:f,className:"openverse-load-more button button-secondary"},f?(0,l.createElement)(r.Spinner,null):(0,o.__)("Load More","openverse-connect"))))));var $},save:function({attributes:e}){const n=s.useBlockProps.save(),{selectedMedia:t,showAttribution:a,mediaType:o,imageSize:r,maxWidth:c,altText:i}=e;return t?(0,l.createElement)("figure",{...n},"image"===o?(0,l.createElement)("img",{src:t.url,alt:i||t.title||"",className:`size-${r}`,style:{maxWidth:`${c}%`}}):(0,l.createElement)("audio",{controls:!0},(0,l.createElement)("source",{src:t.url,type:"audio/mpeg"}),"Your browser does not support the audio element."),a?(0,l.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},"Creator: ",t.creator||"Unknown"," | License: ",t.license):null):(0,l.createElement)("div",{...n})}})}},t={};function a(e){var o=t[e];if(void 0!==o)return o.exports;var l=t[e]={exports:{}};return n[e](l,l.exports,a),l.exports}a.m=n,e=[],a.O=(n,t,o,l)=>{if(!t){var r=1/0;for(m=0;m<e.length;m++){for(var[t,o,l]=e[m],c=!0,s=0;s<t.length;s++)(!1&l||r>=l)&&Object.keys(a.O).every((e=>a.O[e](t[s])))?t.splice(s--,1):(c=!1,l<r&&(r=l));if(c){e.splice(m--,1);var i=o();void 0!==i&&(n=i)}}return n}l=l||0;for(var m=e.length;m>0&&e[m-1][2]>l;m--)e[m]=e[m-1];e[m]=[t,o,l]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={383:0,46:0};a.O.j=n=>0===e[n];var n=(n,t)=>{var o,l,[r,c,s]=t,i=0;if(r.some((n=>0!==e[n]))){for(o in c)a.o(c,o)&&(a.m[o]=c[o]);if(s)var m=s(a)}for(n&&n(t);i<r.length;i++)l=r[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(m)},t=globalThis.webpackChunkopenverse_connect=globalThis.webpackChunkopenverse_connect||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var o=a.O(void 0,[46],(()=>a(890)));o=a.O(o)})();