(()=>{"use strict";var e,n={674:(e,n,t)=>{const r=window.wp.blocks,a=window.wp.i18n,o=window.React,l=window.wp.components,c=window.wp.element,s=window.wp.blockEditor,i=window.wp.apiFetch;var m=t.n(i);(0,r.registerBlockType)("openverse-connect/search",{title:(0,a.__)("Openverse Search","openverse-connect"),description:(0,a.__)("Search and insert media from Openverse","openverse-connect"),icon:"search",category:"media",keywords:[(0,a.__)("openverse","openverse-connect"),(0,a.__)("image","openverse-connect"),(0,a.__)("search","openverse-connect")],edit:function({attributes:e,setAttributes:n}){const t=(0,s.useBlockProps)(),{query:r,mediaType:i,license:v,selectedMedia:p,showAttribution:u,imageSize:d,maxWidth:_}=e,[h,b]=(0,c.useState)([]),[E,g]=(0,c.useState)(!1),[C,w]=(0,c.useState)(null),[S,y]=(0,c.useState)(1),[f,N]=(0,c.useState)(!1),k=async(e=!0)=>{if(r.trim()){g(!0),w(null);try{const n=e?1:S,t=await m()({path:`/openverse-connect/v1/search?q=${encodeURIComponent(r)}&page=${n}&media_type=${i}&license=${v}`,method:"GET"});t.results?(e?(b(t.results),y(1)):b([...h,...t.results]),N(t.page_count>n)):(w((0,a.__)("No results found","openverse-connect")),b([]))}catch(e){w((0,a.__)("Error searching Openverse","openverse-connect")),console.error("Openverse search error:",e)}finally{g(!1)}}},B=[{label:(0,a.__)("All licenses","openverse-connect"),value:"all"},{label:(0,a.__)("CC BY","openverse-connect"),value:"BY"},{label:(0,a.__)("CC BY-SA","openverse-connect"),value:"BY-SA"},{label:(0,a.__)("CC BY-ND","openverse-connect"),value:"BY-ND"},{label:(0,a.__)("CC BY-NC","openverse-connect"),value:"BY-NC"},{label:(0,a.__)("CC BY-NC-SA","openverse-connect"),value:"BY-NC-SA"},{label:(0,a.__)("CC BY-NC-ND","openverse-connect"),value:"BY-NC-ND"},{label:(0,a.__)("CC0","openverse-connect"),value:"CC0"},{label:(0,a.__)("Public Domain Mark","openverse-connect"),value:"PDM"}],O=[{label:(0,a.__)("Images","openverse-connect"),value:"image"},{label:(0,a.__)("Audio","openverse-connect"),value:"audio"}],M=[{label:(0,a.__)("Small","openverse-connect"),value:"small"},{label:(0,a.__)("Medium","openverse-connect"),value:"medium"},{label:(0,a.__)("Large","openverse-connect"),value:"large"}];return(0,o.createElement)("div",{...t},p?(0,o.createElement)(o.Fragment,null,p?(0,o.createElement)("div",{className:"openverse-selected-media",style:{maxWidth:`${_}%`}},"image"===i?(0,o.createElement)("img",{src:p.thumbnail||p.url,alt:p.title,className:`size-${d}`}):(0,o.createElement)("audio",{controls:!0},(0,o.createElement)("source",{src:p.url,type:"audio/mpeg"}),(0,a.__)("Your browser does not support the audio element.","openverse-connect")),u&&((Y=p)?(0,o.createElement)("div",{className:"openverse-attribution"},(0,o.createElement)("small",null,(0,a.__)("Creator:","openverse-connect")," ",Y.creator||(0,a.__)("Unknown","openverse-connect")," |",(0,a.__)("License:","openverse-connect")," ",Y.license)):null),(0,o.createElement)(l.Button,{isSecondary:!0,onClick:()=>{n({selectedMedia:null})},className:"openverse-reset-selection"},(0,a.__)("Choose Different Media","openverse-connect"))):null,(0,o.createElement)(l.Panel,null,(0,o.createElement)(l.PanelBody,{title:(0,a.__)("Media Settings","openverse-connect"),initialOpen:!1},(0,o.createElement)(l.ToggleControl,{label:(0,a.__)("Show Attribution","openverse-connect"),checked:u,onChange:e=>n({showAttribution:e})}),"image"===i&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(l.SelectControl,{label:(0,a.__)("Image Size","openverse-connect"),value:d,options:M,onChange:e=>n({imageSize:e})}),(0,o.createElement)(l.RangeControl,{label:(0,a.__)("Maximum Width (%)","openverse-connect"),value:_,onChange:e=>n({maxWidth:e}),min:10,max:100}))))):(0,o.createElement)("div",{className:"openverse-search-interface"},(0,o.createElement)(l.Placeholder,{icon:"search",label:(0,a.__)("Openverse Media Search","openverse-connect"),instructions:(0,a.__)("Search for free and openly licensed media from Openverse","openverse-connect")},(0,o.createElement)("div",{className:"openverse-search-controls"},(0,o.createElement)(l.SelectControl,{label:(0,a.__)("Media Type","openverse-connect"),value:i,options:O,onChange:e=>n({mediaType:e})}),(0,o.createElement)(l.SelectControl,{label:(0,a.__)("License","openverse-connect"),value:v,options:B,onChange:e=>n({license:e})}),(0,o.createElement)(l.TextControl,{label:(0,a.__)("Search Query","openverse-connect"),value:r,onChange:e=>n({query:e}),placeholder:(0,a.__)("Enter search terms...","openverse-connect")}),(0,o.createElement)(l.Button,{isPrimary:!0,onClick:()=>k(!0),disabled:!r.trim()||E},E?(0,o.createElement)(l.Spinner,null):(0,a.__)("Search","openverse-connect")))),C&&(0,o.createElement)("div",{className:"openverse-error-message"},C),h.length>0&&(0,o.createElement)("div",{className:"openverse-search-results"},(0,o.createElement)("h3",null,(0,a.__)("Search Results","openverse-connect")),(0,o.createElement)("div",{className:"openverse-results-grid"},h.map((e=>(0,o.createElement)("div",{key:e.id,className:"openverse-result-item",onClick:()=>{n({selectedMedia:e})}},"image"===i?(0,o.createElement)("img",{src:e.thumbnail,alt:e.title}):(0,o.createElement)("div",{className:"openverse-audio-item"},(0,o.createElement)("span",{className:"dashicons dashicons-format-audio"}),(0,o.createElement)("span",{className:"openverse-audio-title"},e.title)))))),f&&(0,o.createElement)(l.Button,{isSecondary:!0,onClick:()=>{y(S+1),k(!1)},disabled:E,className:"openverse-load-more"},E?(0,o.createElement)(l.Spinner,null):(0,a.__)("Load More","openverse-connect")))));var Y},save:function({attributes:e}){const n=s.useBlockProps.save(),{selectedMedia:t,showAttribution:r,mediaType:a,imageSize:l,maxWidth:c}=e;return t?(0,o.createElement)("div",{...n,style:{maxWidth:`${c}%`}},"image"===a?(0,o.createElement)("img",{src:t.url,alt:t.title,className:`size-${l}`}):(0,o.createElement)("audio",{controls:!0},(0,o.createElement)("source",{src:t.url,type:"audio/mpeg"}),"Your browser does not support the audio element."),r?(0,o.createElement)("div",{className:"openverse-attribution"},(0,o.createElement)("small",null,"Creator: ",t.creator||"Unknown"," | License: ",t.license)):null):(0,o.createElement)("div",{...n})}})}},t={};function r(e){var a=t[e];if(void 0!==a)return a.exports;var o=t[e]={exports:{}};return n[e](o,o.exports,r),o.exports}r.m=n,e=[],r.O=(n,t,a,o)=>{if(!t){var l=1/0;for(m=0;m<e.length;m++){for(var[t,a,o]=e[m],c=!0,s=0;s<t.length;s++)(!1&o||l>=o)&&Object.keys(r.O).every((e=>r.O[e](t[s])))?t.splice(s--,1):(c=!1,o<l&&(l=o));if(c){e.splice(m--,1);var i=a();void 0!==i&&(n=i)}}return n}o=o||0;for(var m=e.length;m>0&&e[m-1][2]>o;m--)e[m]=e[m-1];e[m]=[t,a,o]},r.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return r.d(n,{a:n}),n},r.d=(e,n)=>{for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={383:0,46:0};r.O.j=n=>0===e[n];var n=(n,t)=>{var a,o,[l,c,s]=t,i=0;if(l.some((n=>0!==e[n]))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(s)var m=s(r)}for(n&&n(t);i<l.length;i++)o=l[i],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(m)},t=globalThis.webpackChunkopenverse_connect=globalThis.webpackChunkopenverse_connect||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var a=r.O(void 0,[46],(()=>r(674)));a=r.O(a)})();