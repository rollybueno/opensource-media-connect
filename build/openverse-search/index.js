(()=>{"use strict";var e,t={676:(e,t,n)=>{const a=window.wp.blocks,o=window.wp.i18n,r=window.React,c=window.wp.components,l=window.wp.element,i=window.wp.blockEditor,s=window.wp.primitives,m=(0,r.createElement)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(s.Path,{d:"M16 10h4c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1h-4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1zm-8 4H4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm10-2.6L14.5 15l1.1 1.1 1.7-1.7c-.1 1.1-.3 2.3-.9 2.9-.3.3-.7.5-1.3.5h-4.5v1.5H15c.9 0 1.7-.3 2.3-.9 1-1 1.3-2.7 1.4-4l1.8 1.8 1.1-1.1-3.6-3.7zM6.8 9.7c.1-1.1.3-2.3.9-2.9.4-.4.8-.6 1.3-.6h4.5V4.8H9c-.9 0-1.7.3-2.3.9-1 1-1.3 2.7-1.4 4L3.5 8l-1 1L6 12.6 9.5 9l-1-1-1.7 1.7z"})),p=window.wp.apiFetch;var u=n.n(p);const d=window.wp.escapeHtml;(0,a.registerBlockType)("openverse-connect/search",{title:(0,o.__)("Open Source Media","opensource-media-connect"),description:(0,o.__)("Search and insert media from Openverse","opensource-media-connect"),icon:"format-image",category:"media",keywords:[(0,o.__)("openverse","opensource-media-connect"),(0,o.__)("image","opensource-media-connect"),(0,o.__)("search","opensource-media-connect")],edit:function({attributes:e,setAttributes:t}){const n=(0,i.useBlockProps)(),{query:a,mediaType:s,license:p,selectedMedia:_,showAttribution:v,imageSize:h,maxWidth:g,altText:E,imageCaption:w}=e,[b,f]=(0,l.useState)([]),[x,y]=(0,l.useState)(!1),[C,S]=(0,l.useState)(null),[M,k]=(0,l.useState)(1),[T,N]=(0,l.useState)(!1),[B,O]=(0,l.useState)(!1),H=(0,l.useRef)(null),L=async(e=!0)=>{if(a.trim()){y(!0),S(null);try{const t=e?1:M,n=await u()({path:`/opensource-media-connect/v1/search?q=${encodeURIComponent(a)}&page=${t}&media_type=${s}&license=${p}`,method:"GET"});n.results?(e?(f(n.results),k(1)):f([...b,...n.results]),N(n.page_count>t)):(S((0,o.__)("No results found","opensource-media-connect")),f([]))}catch(e){S((0,o.__)("Error searching Openverse","opensource-media-connect")),console.error("Openverse search error:",e)}finally{y(!1)}}},z=e=>{const n=e.title||"",a=e.caption||"";t({selectedMedia:e,altText:E||(0,d.escapeHTML)(n),imageCaption:a||(0,d.escapeHTML)(a)})},P=[{label:(0,o.__)("Small","opensource-media-connect"),value:"small"},{label:(0,o.__)("Medium","opensource-media-connect"),value:"medium"},{label:(0,o.__)("Large","opensource-media-connect"),value:"large"}];return(0,r.createElement)(r.Fragment,null,_&&!B&&(0,r.createElement)(i.BlockControls,null,(0,r.createElement)(c.ToolbarGroup,null,(0,r.createElement)(c.ToolbarButton,{icon:m,label:(0,o.__)("Replace Media","opensource-media-connect"),onClick:()=>{t({selectedMedia:null}),H.current=_,O(!0)}}))),(0,r.createElement)(i.InspectorControls,null,(0,r.createElement)(c.PanelBody,{title:(0,o.__)("Media Settings","opensource-media-connect"),initialOpen:!0},(0,r.createElement)((()=>{const[e,n]=(0,l.useState)(E||""),[a,i]=(0,l.useState)(_?.caption||"");return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.ToggleControl,{label:(0,o.__)("Show Attribution","opensource-media-connect"),checked:v,onChange:e=>{t({showAttribution:e})},__nextHasNoMarginBottom:!0}),"image"===s&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.TextControl,{label:(0,o.__)("Caption","opensource-media-connect"),value:a,onChange:e=>i(e),onBlur:()=>{_&&t({selectedMedia:{..._,caption:(0,d.escapeHTML)(a)},imageCaption:(0,d.escapeHTML)(a)})},help:(0,o.__)("Add a caption to display below the image.","opensource-media-connect"),__nextHasNoMarginBottom:!0}),(0,r.createElement)(c.TextControl,{label:(0,o.__)("Alt Text","opensource-media-connect"),value:e,onChange:e=>n(e),onBlur:()=>t({altText:(0,d.escapeHTML)(e)}),help:(0,o.__)("Alternative text describes your image to people who can't see it. Add a short description with its key details.","opensource-media-connect"),__nextHasNoMarginBottom:!0})))}),null),"image"===s&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.SelectControl,{label:(0,o.__)("Image Size","opensource-media-connect"),value:h,options:P,onChange:e=>t({imageSize:e}),__nextHasNoMarginBottom:!0}),(0,r.createElement)(c.RangeControl,{label:(0,o.__)("Maximum Width (%)","opensource-media-connect"),value:g,onChange:e=>t({maxWidth:e}),min:10,max:100,__nextHasNoMarginBottom:!0})))),(0,r.createElement)("div",{...n},_&&!B?_?(0,r.createElement)("div",{className:"openverse-selected-media"},(0,r.createElement)("figure",null,(0,r.createElement)("img",{src:_.thumbnail||_.url,alt:E||_.title||"",className:`size-${h}`,style:{maxWidth:`${g}%`}}),_.caption&&(0,r.createElement)("figcaption",{className:"wp-element-caption"},_.caption),v&&((A=_)?(0,r.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},(0,o.__)("Creator:","opensource-media-connect")," ",A.creator||(0,o.__)("Unknown","opensource-media-connect")," |",(0,o.__)("License:","opensource-media-connect")," ",A.license):null))):null:(0,r.createElement)("div",{className:"openverse-search-interface"},(0,r.createElement)(c.Placeholder,{icon:"search",label:(0,o.__)("Open Source Media Search","opensource-media-connect"),instructions:(0,o.__)("Search for free and openly licensed media from Openverse","opensource-media-connect")},(0,r.createElement)("div",{className:"openverse-search-controls"},(0,r.createElement)(c.TextControl,{label:(0,o.__)("Search Query","opensource-media-connect"),hideLabelFromVision:!0,value:a,onChange:e=>t({query:e}),placeholder:(0,o.__)("Enter search terms...","opensource-media-connect"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,r.createElement)("div",{className:"openverse-search-buttons",style:{display:"flex",gap:"8px",marginTop:"10px"}},(0,r.createElement)(c.Button,{variant:"primary",onClick:()=>L(!0),disabled:!a.trim()||x},x?(0,r.createElement)(c.Spinner,null):(0,o.__)("Search","opensource-media-connect")),H.current&&(0,r.createElement)(c.Button,{variant:"secondary",onClick:()=>{t({query:"",mediaType:"image",license:"all"}),f([]),O(!1),H.current&&t({selectedMedia:H.current})},className:"openverse-cancel-search"},(0,o.__)("Cancel","opensource-media-connect"))))),C&&(0,r.createElement)("div",{className:"openverse-error-message"},C),b.length>0&&(0,r.createElement)("div",{className:"openverse-search-results"},(0,r.createElement)("h3",null,(0,o.__)("Search Results","opensource-media-connect")),(0,r.createElement)("div",{className:"openverse-results-grid"},b.map((e=>(0,r.createElement)("div",{key:e.id,className:"openverse-result-item",onClick:t=>{t.stopPropagation(),z(e),O(!1)},role:"button",tabIndex:0,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),z(e),O(!1))}},(0,r.createElement)("img",{src:e.thumbnail,alt:e.title,onClick:t=>{t.stopPropagation(),z(e),O(!1)}}))))),T&&(0,r.createElement)(c.Button,{onClick:()=>{k(M+1),L(!1)},disabled:x,className:"openverse-load-more button button-secondary"},x?(0,r.createElement)(c.Spinner,null):(0,o.__)("Load More","opensource-media-connect"))))));var A},save:function({attributes:e}){const t=i.useBlockProps.save(),{selectedMedia:n,showAttribution:a,imageSize:o,maxWidth:c,altText:l,imageCaption:s}=e;return n?(0,r.createElement)("figure",{...t},(0,r.createElement)("img",{src:n.url,alt:l||n.title||"",className:`size-${o}`,style:{maxWidth:`${c}%`}}),a||s?(0,r.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},s&&(0,r.createElement)(r.Fragment,null,s,(0,r.createElement)("br",null)),a&&(0,r.createElement)(r.Fragment,null,"Creator: ",n.creator||"Unknown"," | License: ",n.license)):null):(0,r.createElement)("div",{...t})}})}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,n,o,r)=>{if(!n){var c=1/0;for(m=0;m<e.length;m++){for(var[n,o,r]=e[m],l=!0,i=0;i<n.length;i++)(!1&r||c>=r)&&Object.keys(a.O).every((e=>a.O[e](n[i])))?n.splice(i--,1):(l=!1,r<c&&(c=r));if(l){e.splice(m--,1);var s=o();void 0!==s&&(t=s)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[n,o,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={383:0,46:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[c,l,i]=n,s=0;if(c.some((t=>0!==e[t]))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(i)var m=i(a)}for(t&&t(n);s<c.length;s++)r=c[s],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(m)},n=globalThis.webpackChunkopenverse_connect=globalThis.webpackChunkopenverse_connect||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[46],(()=>a(676)));o=a.O(o)})();