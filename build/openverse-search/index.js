(()=>{"use strict";var e,n={890:(e,n,t)=>{const a=window.wp.blocks,l=window.wp.i18n,r=window.React,o=window.wp.components,c=window.wp.element,s=window.wp.blockEditor,i=window.wp.primitives,m=(0,r.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(i.Path,{fillRule:"evenodd",d:"M10.289 4.836A1 1 0 0111.275 4h1.306a1 1 0 01.987.836l.244 1.466c.787.26 1.503.679 2.108 1.218l1.393-.522a1 1 0 011.216.437l.653 1.13a1 1 0 01-.23 1.273l-1.148.944a6.025 6.025 0 010 2.435l1.149.946a1 1 0 01.23 1.272l-.653 1.13a1 1 0 01-1.216.437l-1.394-.522c-.605.54-1.32.958-2.108 1.218l-.244 1.466a1 1 0 01-.987.836h-1.306a1 1 0 01-.986-.836l-.244-1.466a5.995 5.995 0 01-2.108-1.218l-1.394.522a1 1 0 01-1.217-.436l-.653-1.131a1 1 0 01.23-1.272l1.149-.946a6.026 6.026 0 010-2.435l-1.148-.944a1 1 0 01-.23-1.272l.653-1.131a1 1 0 011.217-.437l1.393.522a5.994 5.994 0 012.108-1.218l.244-1.466zM14.929 12a3 3 0 11-6 0 3 3 0 016 0z",clipRule:"evenodd"})),p=(0,r.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(i.Path,{d:"M16 10h4c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1h-4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1zm-8 4H4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm10-2.6L14.5 15l1.1 1.1 1.7-1.7c-.1 1.1-.3 2.3-.9 2.9-.3.3-.7.5-1.3.5h-4.5v1.5H15c.9 0 1.7-.3 2.3-.9 1-1 1.3-2.7 1.4-4l1.8 1.8 1.1-1.1-3.6-3.7zM6.8 9.7c.1-1.1.3-2.3.9-2.9.4-.4.8-.6 1.3-.6h4.5V4.8H9c-.9 0-1.7.3-2.3.9-1 1-1.3 2.7-1.4 4L3.5 8l-1 1L6 12.6 9.5 9l-1-1-1.7 1.7z"})),v=window.wp.apiFetch;var u=t.n(v);const d=window.wp.escapeHtml;(0,a.registerBlockType)("openverse-connect/search",{title:(0,l.__)("Openverse Search","openverse-connect"),description:(0,l.__)("Search and insert media from Openverse","openverse-connect"),icon:"search",category:"media",keywords:[(0,l.__)("openverse","openverse-connect"),(0,l.__)("image","openverse-connect"),(0,l.__)("search","openverse-connect")],edit:function({attributes:e,setAttributes:n}){const t=(0,s.useBlockProps)(),{query:a,mediaType:i,license:v,selectedMedia:_,showAttribution:h,imageSize:g,maxWidth:E,altText:b}=e,[w,C]=(0,c.useState)([]),[f,y]=(0,c.useState)(!1),[S,N]=(0,c.useState)(null),[x,k]=(0,c.useState)(1),[B,T]=(0,c.useState)(!1),[M,O]=(0,c.useState)(!1),A=(0,c.useRef)(null),Y=async(e=!0)=>{if(a.trim()){y(!0),N(null);try{const n=e?1:x,t=await u()({path:`/openverse-connect/v1/search?q=${encodeURIComponent(a)}&page=${n}&media_type=${i}&license=${v}`,method:"GET"});t.results?(e?(C(t.results),k(1)):C([...w,...t.results]),T(t.page_count>n)):(N((0,l.__)("No results found","openverse-connect")),C([]))}catch(e){N((0,l.__)("Error searching Openverse","openverse-connect")),console.error("Openverse search error:",e)}finally{y(!1)}}},z=e=>{const n=e.replace(/<\/?[^>]+(>|$)/g,"");return(0,d.escapeHTML)(n)},P=[{label:(0,l.__)("All licenses","openverse-connect"),value:"all"},{label:(0,l.__)("CC BY","openverse-connect"),value:"BY"},{label:(0,l.__)("CC BY-SA","openverse-connect"),value:"BY-SA"},{label:(0,l.__)("CC BY-ND","openverse-connect"),value:"BY-ND"},{label:(0,l.__)("CC BY-NC","openverse-connect"),value:"BY-NC"},{label:(0,l.__)("CC BY-NC-SA","openverse-connect"),value:"BY-NC-SA"},{label:(0,l.__)("CC BY-NC-ND","openverse-connect"),value:"BY-NC-ND"},{label:(0,l.__)("CC0","openverse-connect"),value:"CC0"},{label:(0,l.__)("Public Domain Mark","openverse-connect"),value:"PDM"}],L=[{label:(0,l.__)("Images","openverse-connect"),value:"image"},{label:(0,l.__)("Audio","openverse-connect"),value:"audio"}],$=[{label:(0,l.__)("Small","openverse-connect"),value:"small"},{label:(0,l.__)("Medium","openverse-connect"),value:"medium"},{label:(0,l.__)("Large","openverse-connect"),value:"large"}],D=()=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.ToggleControl,{label:(0,l.__)("Show Attribution","openverse-connect"),checked:h,onChange:e=>n({showAttribution:e})}),"image"===i&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.TextControl,{label:(0,l.__)("Alt Text","openverse-connect"),value:b,onChange:e=>n({altText:z(e)}),help:(0,l.__)("Alternative text describes your image to people who can't see it. Add a short description with its key details.","openverse-connect")}),(0,r.createElement)(o.SelectControl,{label:(0,l.__)("Image Size","openverse-connect"),value:g,options:$,onChange:e=>n({imageSize:e})}),(0,r.createElement)(o.RangeControl,{label:(0,l.__)("Maximum Width (%)","openverse-connect"),value:E,onChange:e=>n({maxWidth:e}),min:10,max:100})));return(0,r.createElement)(r.Fragment,null,_&&!M&&(0,r.createElement)(s.BlockControls,null,(0,r.createElement)(o.ToolbarGroup,null,(0,r.createElement)(o.ToolbarButton,{icon:p,label:(0,l.__)("Choose Different Media","openverse-connect"),onClick:()=>{n({selectedMedia:null}),A.current=_,O(!0)}}),(0,r.createElement)((()=>(0,r.createElement)(o.Dropdown,{className:"openverse-media-settings-dropdown",contentClassName:"openverse-media-settings-dropdown-content",popoverProps:{placement:"bottom-start",offset:20,shift:!0,flip:!0,resize:!0,headerTitle:(0,l.__)("Media Settings","openverse-connect")},renderToggle:({isOpen:e,onToggle:n})=>(0,r.createElement)(o.ToolbarButton,{icon:m,label:(0,l.__)("Media Settings","openverse-connect"),onClick:n,"aria-expanded":e,isPressed:e}),renderContent:()=>(0,r.createElement)("div",{className:"openverse-media-settings-panel",style:{minWidth:"300px",maxWidth:"500px",height:"auto",padding:"20px",margin:"auto"}},(0,r.createElement)(D,null))})),null))),(0,r.createElement)(s.InspectorControls,null,(0,r.createElement)(o.PanelBody,{title:(0,l.__)("Media Settings","openverse-connect"),initialOpen:!0},(0,r.createElement)(D,null))),(0,r.createElement)("div",{...t},_&&!M?_?(0,r.createElement)("div",{className:"openverse-selected-media"},"image"===i?(0,r.createElement)("img",{src:_.thumbnail||_.url,alt:b||_.title||"",className:`size-${g}`,style:{maxWidth:`${E}%`}}):(0,r.createElement)("audio",{controls:!0},(0,r.createElement)("source",{src:_.url,type:"audio/mpeg"}),(0,l.__)("Your browser does not support the audio element.","openverse-connect")),h&&((W=_)?(0,r.createElement)("div",{className:"openverse-attribution"},(0,r.createElement)("small",null,(0,l.__)("Creator:","openverse-connect")," ",W.creator||(0,l.__)("Unknown","openverse-connect")," |",(0,l.__)("License:","openverse-connect")," ",W.license)):null)):null:(0,r.createElement)("div",{className:"openverse-search-interface"},(0,r.createElement)(o.Placeholder,{icon:"search",label:(0,l.__)("Openverse Media Search","openverse-connect"),instructions:(0,l.__)("Search for free and openly licensed media from Openverse","openverse-connect")},(0,r.createElement)("div",{className:"openverse-search-controls"},(0,r.createElement)(o.SelectControl,{label:(0,l.__)("Media Type","openverse-connect"),value:i,options:L,onChange:e=>n({mediaType:e})}),(0,r.createElement)(o.SelectControl,{label:(0,l.__)("License","openverse-connect"),value:v,options:P,onChange:e=>n({license:e})}),(0,r.createElement)(o.TextControl,{label:(0,l.__)("Search Query","openverse-connect"),value:a,onChange:e=>n({query:e}),placeholder:(0,l.__)("Enter search terms...","openverse-connect")}),(0,r.createElement)("div",{className:"openverse-search-buttons"},(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>Y(!0),disabled:!a.trim()||f},f?(0,r.createElement)(o.Spinner,null):(0,l.__)("Search","openverse-connect")),A.current&&(0,r.createElement)(o.Button,{isSecondary:!0,onClick:()=>{n({query:"",mediaType:"image",license:"all"}),C([]),O(!1),A.current&&n({selectedMedia:A.current})},className:"openverse-cancel-search"},(0,l.__)("Cancel","openverse-connect"))))),S&&(0,r.createElement)("div",{className:"openverse-error-message"},S),w.length>0&&(0,r.createElement)("div",{className:"openverse-search-results"},(0,r.createElement)("h3",null,(0,l.__)("Search Results","openverse-connect")),(0,r.createElement)("div",{className:"openverse-results-grid"},w.map((e=>(0,r.createElement)("div",{key:e.id,className:"openverse-result-item",onClick:()=>(e=>{const t=e.title||"";n({selectedMedia:e,altText:b||z(t)})})(e)},"image"===i?(0,r.createElement)("img",{src:e.thumbnail,alt:e.title}):(0,r.createElement)("div",{className:"openverse-audio-item"},(0,r.createElement)("span",{className:"dashicons dashicons-format-audio"}),(0,r.createElement)("span",{className:"openverse-audio-title"},e.title)))))),B&&(0,r.createElement)(o.Button,{onClick:()=>{k(x+1),Y(!1)},disabled:f,className:"openverse-load-more button button-secondary"},f?(0,r.createElement)(o.Spinner,null):(0,l.__)("Load More","openverse-connect"))))));var W},save:function({attributes:e}){const n=s.useBlockProps.save(),{selectedMedia:t,showAttribution:a,mediaType:l,imageSize:o,maxWidth:c,altText:i}=e;return t?(0,r.createElement)("figure",{...n},"image"===l?(0,r.createElement)("img",{src:t.url,alt:i||t.title||"",className:`size-${o}`,style:{maxWidth:`${c}%`}}):(0,r.createElement)("audio",{controls:!0},(0,r.createElement)("source",{src:t.url,type:"audio/mpeg"}),"Your browser does not support the audio element."),a?(0,r.createElement)("div",{className:"openverse-attribution"},(0,r.createElement)("small",null,"Creator: ",t.creator||"Unknown"," | License: ",t.license)):null):(0,r.createElement)("div",{...n})}})}},t={};function a(e){var l=t[e];if(void 0!==l)return l.exports;var r=t[e]={exports:{}};return n[e](r,r.exports,a),r.exports}a.m=n,e=[],a.O=(n,t,l,r)=>{if(!t){var o=1/0;for(m=0;m<e.length;m++){for(var[t,l,r]=e[m],c=!0,s=0;s<t.length;s++)(!1&r||o>=r)&&Object.keys(a.O).every((e=>a.O[e](t[s])))?t.splice(s--,1):(c=!1,r<o&&(o=r));if(c){e.splice(m--,1);var i=l();void 0!==i&&(n=i)}}return n}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[t,l,r]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={383:0,46:0};a.O.j=n=>0===e[n];var n=(n,t)=>{var l,r,[o,c,s]=t,i=0;if(o.some((n=>0!==e[n]))){for(l in c)a.o(c,l)&&(a.m[l]=c[l]);if(s)var m=s(a)}for(n&&n(t);i<o.length;i++)r=o[i],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(m)},t=globalThis.webpackChunkopenverse_connect=globalThis.webpackChunkopenverse_connect||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var l=a.O(void 0,[46],(()=>a(890)));l=a.O(l)})();