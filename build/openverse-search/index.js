(()=>{"use strict";var e,t={676:(e,t,n)=>{const a=window.wp.blocks,r=window.wp.i18n,o=window.React,l=window.wp.components,c=window.wp.element,s=window.wp.blockEditor,i=window.wp.primitives,p=(0,o.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(i.Path,{d:"M16 10h4c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1h-4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1zm-8 4H4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm10-2.6L14.5 15l1.1 1.1 1.7-1.7c-.1 1.1-.3 2.3-.9 2.9-.3.3-.7.5-1.3.5h-4.5v1.5H15c.9 0 1.7-.3 2.3-.9 1-1 1.3-2.7 1.4-4l1.8 1.8 1.1-1.1-3.6-3.7zM6.8 9.7c.1-1.1.3-2.3.9-2.9.4-.4.8-.6 1.3-.6h4.5V4.8H9c-.9 0-1.7.3-2.3.9-1 1-1.3 2.7-1.4 4L3.5 8l-1 1L6 12.6 9.5 9l-1-1-1.7 1.7z"})),m=window.wp.apiFetch;var u=n.n(m);const v=window.wp.escapeHtml;(0,a.registerBlockType)("openverse-connect/search",{title:(0,r.__)("Openverse Image","openverse-connect"),description:(0,r.__)("Search and insert media from Openverse","openverse-connect"),icon:"image",category:"media",keywords:[(0,r.__)("openverse","openverse-connect"),(0,r.__)("image","openverse-connect"),(0,r.__)("search","openverse-connect")],edit:function({attributes:e,setAttributes:t}){const n=(0,s.useBlockProps)(),{query:a,mediaType:i,license:m,selectedMedia:d,showAttribution:_,imageSize:h,maxWidth:g,altText:E,imageCaption:w}=e,[b,f]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1),[C,M]=(0,c.useState)(null),[S,k]=(0,c.useState)(1),[T,N]=(0,c.useState)(!1),[B,O]=(0,c.useState)(!1),H=(0,c.useRef)(null),L=async(e=!0)=>{if(a.trim()){y(!0),M(null);try{const t=e?1:S,n=await u()({path:`/openverse-connect/v1/search?q=${encodeURIComponent(a)}&page=${t}&media_type=${i}&license=${m}`,method:"GET"});n.results?(e?(f(n.results),k(1)):f([...b,...n.results]),N(n.page_count>t)):(M((0,r.__)("No results found","openverse-connect")),f([]))}catch(e){M((0,r.__)("Error searching Openverse","openverse-connect")),console.error("Openverse search error:",e)}finally{y(!1)}}},z=e=>{const n=e.title||"",a=e.caption||"";t({selectedMedia:e,altText:E||(0,v.escapeHTML)(n),imageCaption:a||(0,v.escapeHTML)(a)})},P=[{label:(0,r.__)("Small","openverse-connect"),value:"small"},{label:(0,r.__)("Medium","openverse-connect"),value:"medium"},{label:(0,r.__)("Large","openverse-connect"),value:"large"}];return(0,o.createElement)(o.Fragment,null,d&&!B&&(0,o.createElement)(s.BlockControls,null,(0,o.createElement)(l.ToolbarGroup,null,(0,o.createElement)(l.ToolbarButton,{icon:p,label:(0,r.__)("Replace Media","openverse-connect"),onClick:()=>{t({selectedMedia:null}),H.current=d,O(!0)}}))),(0,o.createElement)(s.InspectorControls,null,(0,o.createElement)(l.PanelBody,{title:(0,r.__)("Media Settings","openverse-connect"),initialOpen:!0},(0,o.createElement)((()=>{const[e,n]=(0,c.useState)(E||""),[a,s]=(0,c.useState)(d?.caption||"");return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(l.ToggleControl,{label:(0,r.__)("Show Attribution","openverse-connect"),checked:_,onChange:e=>{t({showAttribution:e})},__nextHasNoMarginBottom:!0}),"image"===i&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(l.TextControl,{label:(0,r.__)("Caption","openverse-connect"),value:a,onChange:e=>s(e),onBlur:()=>{d&&t({selectedMedia:{...d,caption:(0,v.escapeHTML)(a)},imageCaption:(0,v.escapeHTML)(a)})},help:(0,r.__)("Add a caption to display below the image.","openverse-connect"),__nextHasNoMarginBottom:!0}),(0,o.createElement)(l.TextControl,{label:(0,r.__)("Alt Text","openverse-connect"),value:e,onChange:e=>n(e),onBlur:()=>t({altText:(0,v.escapeHTML)(e)}),help:(0,r.__)("Alternative text describes your image to people who can't see it. Add a short description with its key details.","openverse-connect"),__nextHasNoMarginBottom:!0})))}),null),"image"===i&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(l.SelectControl,{label:(0,r.__)("Image Size","openverse-connect"),value:h,options:P,onChange:e=>t({imageSize:e}),__nextHasNoMarginBottom:!0}),(0,o.createElement)(l.RangeControl,{label:(0,r.__)("Maximum Width (%)","openverse-connect"),value:g,onChange:e=>t({maxWidth:e}),min:10,max:100,__nextHasNoMarginBottom:!0})))),(0,o.createElement)("div",{...n},d&&!B?d?(0,o.createElement)("div",{className:"openverse-selected-media"},(0,o.createElement)("figure",null,(0,o.createElement)("img",{src:d.thumbnail||d.url,alt:E||d.title||"",className:`size-${h}`,style:{maxWidth:`${g}%`}}),d.caption&&(0,o.createElement)("figcaption",{className:"wp-element-caption"},d.caption),_&&((A=d)?(0,o.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},(0,r.__)("Creator:","openverse-connect")," ",A.creator||(0,r.__)("Unknown","openverse-connect")," |",(0,r.__)("License:","openverse-connect")," ",A.license):null))):null:(0,o.createElement)("div",{className:"openverse-search-interface"},(0,o.createElement)(l.Placeholder,{icon:"search",label:(0,r.__)("Openverse Media Search","openverse-connect"),instructions:(0,r.__)("Search for free and openly licensed media from Openverse","openverse-connect")},(0,o.createElement)("div",{className:"openverse-search-controls"},(0,o.createElement)(l.TextControl,{label:(0,r.__)("Search Query","openverse-connect"),hideLabelFromVision:!0,value:a,onChange:e=>t({query:e}),placeholder:(0,r.__)("Enter search terms...","openverse-connect"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,o.createElement)("div",{className:"openverse-search-buttons",style:{display:"flex",gap:"8px",marginTop:"10px"}},(0,o.createElement)(l.Button,{variant:"primary",onClick:()=>L(!0),disabled:!a.trim()||x},x?(0,o.createElement)(l.Spinner,null):(0,r.__)("Search","openverse-connect")),H.current&&(0,o.createElement)(l.Button,{variant:"secondary",onClick:()=>{t({query:"",mediaType:"image",license:"all"}),f([]),O(!1),H.current&&t({selectedMedia:H.current})},className:"openverse-cancel-search"},(0,r.__)("Cancel","openverse-connect"))))),C&&(0,o.createElement)("div",{className:"openverse-error-message"},C),b.length>0&&(0,o.createElement)("div",{className:"openverse-search-results"},(0,o.createElement)("h3",null,(0,r.__)("Search Results","openverse-connect")),(0,o.createElement)("div",{className:"openverse-results-grid"},b.map((e=>(0,o.createElement)("div",{key:e.id,className:"openverse-result-item",onClick:t=>{t.stopPropagation(),z(e),O(!1)},role:"button",tabIndex:0,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),z(e),O(!1))}},(0,o.createElement)("img",{src:e.thumbnail,alt:e.title,onClick:t=>{t.stopPropagation(),z(e),O(!1)}}))))),T&&(0,o.createElement)(l.Button,{onClick:()=>{k(S+1),L(!1)},disabled:x,className:"openverse-load-more button button-secondary"},x?(0,o.createElement)(l.Spinner,null):(0,r.__)("Load More","openverse-connect"))))));var A},save:function({attributes:e}){const t=s.useBlockProps.save(),{selectedMedia:n,showAttribution:a,imageSize:r,maxWidth:l,altText:c,imageCaption:i}=e;return n?(0,o.createElement)("figure",{...t},(0,o.createElement)("img",{src:n.url,alt:c||n.title||"",className:`size-${r}`,style:{maxWidth:`${l}%`}}),a||i?(0,o.createElement)("figcaption",{className:"wp-element-caption openverse-attribution"},i&&(0,o.createElement)(o.Fragment,null,i),a&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("br",null),"Creator: ",n.creator||"Unknown"," | License: ",n.license)):null):(0,o.createElement)("div",{...t})}})}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.m=t,e=[],a.O=(t,n,r,o)=>{if(!n){var l=1/0;for(p=0;p<e.length;p++){for(var[n,r,o]=e[p],c=!0,s=0;s<n.length;s++)(!1&o||l>=o)&&Object.keys(a.O).every((e=>a.O[e](n[s])))?n.splice(s--,1):(c=!1,o<l&&(l=o));if(c){e.splice(p--,1);var i=r();void 0!==i&&(t=i)}}return t}o=o||0;for(var p=e.length;p>0&&e[p-1][2]>o;p--)e[p]=e[p-1];e[p]=[n,r,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={383:0,46:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[l,c,s]=n,i=0;if(l.some((t=>0!==e[t]))){for(r in c)a.o(c,r)&&(a.m[r]=c[r]);if(s)var p=s(a)}for(t&&t(n);i<l.length;i++)o=l[i],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(p)},n=globalThis.webpackChunkopenverse_connect=globalThis.webpackChunkopenverse_connect||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=a.O(void 0,[46],(()=>a(676)));r=a.O(r)})();